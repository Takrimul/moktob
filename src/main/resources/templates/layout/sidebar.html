<!-- Sidebar Fragment -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="sidebar" th:fragment="sidebar">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">
            <i class="fas fa-mosque me-2"></i>
            <strong>Moktob</strong>
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        <nav class="nav flex-column">
            <a class="nav-link" href="/moktob/dashboard">
                <i class="fas fa-tachometer-alt me-2"></i>Dashboard
            </a>
            <a class="nav-link" href="/moktob/students">
                <i class="fas fa-user-graduate me-2"></i>Students
            </a>
            <a class="nav-link" href="/moktob/teachers">
                <i class="fas fa-chalkboard-teacher me-2"></i>Teachers
            </a>
            <a class="nav-link" href="/moktob/classes">
                <i class="fas fa-school me-2"></i>Classes
            </a>
            <a class="nav-link" href="/moktob/attendance">
                <i class="fas fa-calendar-check me-2"></i>Attendance
            </a>
            <a class="nav-link" href="/moktob/assessments">
                <i class="fas fa-clipboard-check me-2"></i>Assessments
            </a>
            <a class="nav-link" href="/moktob/payments">
                <i class="fas fa-credit-card me-2"></i>Payments
            </a>
            <a class="nav-link" href="/moktob/reports">
                <i class="fas fa-chart-bar me-2"></i>Reports
            </a>

            <hr class="my-3">

            <div class="sidebar-heading px-3">Settings</div>
            <a class="nav-link" href="/moktob/profile">
                <i class="fas fa-user-circle me-2"></i>Profile
            </a>
            <a class="nav-link" href="/moktob/settings">
                <i class="fas fa-cog me-2"></i>Settings
            </a>
            <a class="nav-link text-danger" href="/moktob/logout" onclick="return confirmLogout()">
                <i class="fas fa-sign-out-alt me-2"></i>Logout
            </a>
        </nav>
    </div>
</div>

<script>
    function confirmLogout() {
        if (confirm('Are you sure you want to logout?')) {
            return true; // Allow navigation to proceed
        }
        return false; // Prevent navigation
    }

    // Initialize sidebar and add active class based on current URL
    document.addEventListener('DOMContentLoaded', function() {
        // Show sidebar on desktop
        if (window.innerWidth >= 768) {
            const sidebar = document.getElementById('sidebar');
            if (sidebar) {
                sidebar.classList.add('show');
            }
        }

        // Add active class based on current URL
        const currentPath = window.location.pathname;
        const navLinks = document.querySelectorAll('.nav-link');
        
        navLinks.forEach(link => {
            const href = link.getAttribute('href');
            if (href && currentPath.includes(href.replace('/moktob', ''))) {
                link.classList.add('active');
            }
        });
    });
</script>